<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element name="tile-item" attributes="item highlight">
    <template>
        <link rel="stylesheet" href="tile-item.css">

        <div class="tile">
            <div id="title" class="title">[[item.title]]</div>
            <div id="description" class="description">[[item.description]]</div>
            <div class="tags">[[item.tags | names]]</div>
        </div>
    </template>
    <script>
    Polymer({
        highlight: "",

        created: function() {
            this.item = {};
        },

        names: function(objs) {
            if (objs) {
                return objs.map(function(obj) {
                    return obj.name;
                }).join(", ");
            }
            return null;
        },

        highlightChanged: function() {
            var title = this.bgColor(this.item.title);
            this.injectBoundHTML(title, this.$.title);

            var description = this.bgColor(this.item.description);
            this.injectBoundHTML(description, this.$.description);
        },

        bgColor: function(value) {
            if (value && this.highlight) {
                return value.replace(
                    new RegExp('('+this.highlight+')','ig'),
                    '<span style="background-color:yellow">$1</span>');
            }
            return value;
        }
    });
    </script>
</polymer-element>
